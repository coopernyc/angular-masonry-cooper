/*!
 * angular-masonry 0.10.0
 * Pascal Hartig, weluse GmbH, http://weluse.de/
 * License: MIT
 */
(function(){angular.module("wu.masonry",[]).controller("MasonryCtrl",["$scope","$element","$timeout",function(a,e,b){var c={},d=[],f=!1,h=this,g=null;this.preserveOrder=!1;this.loadImages=!0;this.scheduleMasonryOnce=function(){var c=arguments;0<d.filter(function(a){return a[0]===c[0]}).length||this.scheduleMasonry.apply(null,arguments)};this.scheduleMasonry=function(){g&&b.cancel(g);d.push([].slice.call(arguments));g=b(function(){f||(d.forEach(function(c){e.masonry.apply(e,c)}),d=[])},100)};this.appendBrick=function(a,d){function b(){0===Object.keys(c).length&&e.masonry("resize");void 0===c[d]&&(c[d]=!0,a.addClass("loaded"),e.masonry("appended",a,!0))}function g(){h.scheduleMasonryOnce("layout")}f||(h.loadImages?h.preserveOrder?(b(),a.imagesLoaded(g)):a.imagesLoaded(function(){b();g()}):(b(),g()))};this.removeBrick=function(a,b){f||(delete c[a],e.masonry("remove",b),this.scheduleMasonryOnce("layout"))};this.destroy=function(){f=!0;e.data("masonry")&&e.masonry("destroy");a.$emit("masonry.destroyed");c=[]};this.reload=function(){e.masonry();a.$emit("masonry.reloaded")}}]).directive("masonry",function(){return{restrict:"AE",controller:"MasonryCtrl",link:{pre:function(a,e,b,c){var d=a.$eval(b.masonry||b.masonryOptions),d=angular.extend({itemSelector:b.itemSelector||".masonry-brick",columnWidth:parseInt(b.columnWidth,10)||b.columnWidth},d||{});e.masonry(d);d=a.$eval(b.loadImages);c.loadImages=!1!==d;d=a.$eval(b.preserveOrder);c.preserveOrder=!1!==d&&void 0!==b.preserveOrder;!1!==a.$eval(b.reloadOnShow)&&void 0!==b.reloadOnShow&&a.$watch(function(){return e.prop("offsetParent")},function(a,b){a&&!b&&c.reload()});a.$emit("masonry.created",e);a.$on("$destroy",c.destroy)}}}}).directive("masonryBrick",function(){return{restrict:"AC",require:"^masonry",scope:!0,link:{pre:function(a,e,b,c){var d=a.$id,f;c.appendBrick(e,d);e.on("$destroy",function(){c.removeBrick(d,e)});a.$on("masonry.reload",function(){c.scheduleMasonryOnce("reloadItems");c.scheduleMasonryOnce("layout")});a.$watch("$index",function(){void 0!==f&&f!==a.$index&&(c.scheduleMasonryOnce("reloadItems"),c.scheduleMasonryOnce("layout"));f=a.$index})}}}})})();
